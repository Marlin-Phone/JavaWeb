# 实验二  JSP技术及应用

## 班级                       学号                        姓名                   

---

## 一、实验目的
1. 熟练掌握JSP的声明、表达式、小脚本和注释的使用；
2. 理解JSP页面指令和动作的语法格式；
3. 理解JSP页面的生命周期；
4. 熟练掌握page指令的常用属性：import、session、errorPage、isErrorPage、contentType、pageEncoding；
5. 熟练掌握JSP的内置对象及用法；
6. 熟练掌握JSP作用域对象及用法。

## 二、实验原理

### JSP指令元素
JSP有三个指令元素：page、include和taglib。这些指令元素是针对JSP引擎的，并不会产生任何看得见的输出。它们都包含在<%@和%>标签内。

#### page指令
<%@ page %>指令作用于整个JSP页面，包括静态包含的页面，但不包括动态包含的页面。可以在一个页面中包含多个<%@ page %>指令，但其属性除import外只能在整个页面中出现一次。

<%@ page %>指令可以放在页面的任何位置，但为了JSP程序的可读性，一般将<%@ page %>指令放在页面的前面。

### JSP内置对象
JSP中一共预先定义了九大内置对象，分别为：
1. request - 客户端的请求信息
2. response - 对客户端的响应信息
3. session - 会话信息
4. application - 应用程序上下文
5. out - 输出流
6. pageContext - 页面上下文
7. config - Servlet配置信息
8. page - 当前Servlet实例
9. exception - 异常对象（仅在错误页面中可用）

### JSP作用域对象
JSP中有四大作用域对象：
1. pageContext - 页面范围
2. request - 请求范围
3. session - 会话范围
4. application - 应用范围

## 三、实验预习内容

### 1. JSP语法元素有哪些？使用时应注意什么问题？

#### JSP语法元素
1. **JSP脚本元素**
   - 脚本声明（Declaration）：<%! 声明变量或方法 %>
   - 脚本程序段（Scriptlet）：<% Java代码 %>
   - 表达式（Expression）：<%= 表达式 %>

2. **JSP指令元素**
   - page指令：<%@ page 属性="值" %>
   - include指令：<%@ include file="文件名" %>
   - taglib指令：<%@ taglib uri="标签库URI" prefix="前缀" %>

3. **JSP动作元素**
   - jsp:include
   - jsp:forward
   - jsp:param
   - jsp:useBean
   - jsp:setProperty
   - jsp:getProperty

#### 注意事项
1. JSP声明中的变量和方法是类级别的，所有用户共享
2. JSP脚本中的变量是局部变量，每次请求都会重新创建
3. 表达式不能以分号结尾
4. 指令元素不区分大小写，但属性值区分大小写
5. 注意JSP页面的编码设置，避免中文乱码

### 2. JSP页面的生命周期包括哪几个阶段？

JSP页面的生命周期包括以下阶段：

1. **翻译阶段（Translation）**
   - JSP容器将JSP页面翻译成Servlet源代码
   - 生成的Java文件通常在Tomcat的work目录下

2. **编译阶段（Compilation）**
   - 将Servlet源代码编译成字节码文件（.class）
   - 如果编译失败，会在浏览器中显示错误信息

3. **初始化阶段（Initialization）**
   - 容器加载编译后的类文件
   - 调用jspInit()方法进行初始化
   - 只在第一次访问时执行

4. **执行阶段（Execution）**
   - 对于每个请求，容器创建一个新线程
   - 调用_jspService()方法处理请求
   - 生成响应内容发送给客户端

5. **销毁阶段（Destruction）**
   - 容器调用jspDestroy()方法
   - 卸载Servlet类
   - 通常在服务器关闭时执行

### 3. JSP指令和动作有哪些？有什么区别？

#### JSP指令（Directive）
1. **page指令**
   - 用于定义整个JSP页面的属性
   - 例如：language, import, session, errorPage等

2. **include指令**
   - 用于在JSP页面中包含其他文件
   - 在翻译阶段包含，静态包含

3. **taglib指令**
   - 用于定义和访问自定义标签库

#### JSP动作（Action）
1. **jsp:include**
   - 动态包含其他资源
   - 在请求处理阶段包含

2. **jsp:forward**
   - 将请求转发到另一个资源

3. **jsp:param**
   - 为其他动作元素提供参数

4. **jsp:useBean, jsp:setProperty, jsp:getProperty**
   - 用于操作JavaBean组件

#### 区别
- **执行时间**：指令在翻译阶段处理，动作在请求处理阶段执行
- **处理方式**：指令是静态的，动作是动态的
- **作用范围**：指令影响整个页面，动作只影响当前请求

### 4. page指令有哪些常用的属性，这些属性的功能是什么？

| 属性 | 功能 | 示例 |
|------|------|------|
| language | 指定页面使用的脚本语言 | <%@ page language="java" %> |
| import | 导入Java包 | <%@ page import="java.util.*,java.io.*" %> |
| session | 是否自动创建session对象 | <%@ page session="true" %> |
| errorPage | 指定错误处理页面 | <%@ page errorPage="error.jsp" %> |
| isErrorPage | 指定当前页面是否为错误处理页面 | <%@ page isErrorPage="true" %> |
| contentType | 指定响应内容类型和字符编码 | <%@ page contentType="text/html;charset=UTF-8" %> |
| pageEncoding | 指定页面编码 | <%@ page pageEncoding="UTF-8" %> |
| buffer | 指定输出缓冲区大小 | <%@ page buffer="8kb" %> |
| autoFlush | 缓冲区满时是否自动刷新 | <%@ page autoFlush="true" %> |
| isThreadSafe | 页面是否支持多线程 | <%@ page isThreadSafe="true" %> |
| info | 页面描述信息 | <%@ page info="This is a JSP page" %> |

## 四、预习总结

通过本次预习，我对JSP技术有了更深入的理解。JSP作为Java Web开发的重要技术，提供了在HTML中嵌入Java代码的能力，使得动态网页开发更加便捷。理解JSP的生命周期、指令和动作元素的区别，以及各种内置对象的使用方法，对于后续的Web开发实践具有重要意义。