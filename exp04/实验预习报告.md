# 实验四  会话管理

## 一、实验目的
1. 了解Web服务器对客户会话跟踪的各种方法；
2. 重点掌握使用HttpSession对象跟踪会话的方法；
3. 掌握使用Cookie技术跟踪会话的方法；
4. 了解URL重写和隐藏表单域的方法。

## 二、实验原理
HTTP协议是无状态的协议。在很多情况下，Web服务器必须能够跟踪客户的状态。比如，对于一个购物网站，在一个时刻可能有多个客户购物，Web服务器必须能够区分不同的客户。一般情况下，Web服务器为每个客户配置了虚拟的购物车（ShoppingCart）。当某个客户请求将一个商品放入购物车时，Web服务器必须根据发出请求的客户的身份，找到该客户的购物车，然后把商品放入其中。

Web服务器跟踪客户的状态通常有4种方法：
1. 使用HttpSession对象管理会话；
2. 使用持久的Cookie对象；
3. 使用URL重写机制；
4. 使用隐藏的表单域。

## 三、实验预习内容

### 1. 什么是会话，一个会话的生产周期从什么时候，到什么时候结束？

**答：** 会话（Session）是客户端与服务器之间的一次通信过程。在Web应用中，会话指的是从用户打开浏览器访问网站开始，到用户关闭浏览器结束的整个过程。

一个会话的生命周期：
- **开始**：当用户第一次访问Web服务器时，服务器会为该用户创建一个会话对象（HttpSession）
- **维持**：在用户与服务器交互的过程中，会话一直保持活跃状态
- **结束**：当用户关闭浏览器、会话超时（默认30分钟无操作）或显式调用session.invalidate()方法时，会话结束

### 2. 服务器是如何识别管理属于某一个特定客户的会话的？

**答：** 服务器通过会话ID（Session ID）来识别和管理特定客户的会话：

1. 当用户首次访问服务器时，服务器创建一个新的HttpSession对象，并生成唯一的会话ID
2. 服务器将会话ID通过Cookie或URL重写的方式发送给客户端
3. 客户端在后续请求中携带这个会话ID（通过Cookie或作为URL参数）
4. 服务器根据会话ID找到对应的HttpSession对象，从而识别出是哪个用户的请求

### 3. 什么是Cookie，它的作用是什么？Cookie会给客户端带来安全隐患吗？

**答：** Cookie是服务器发送给客户端并保存在客户端的小段数据，当客户端再次访问该服务器时会自动发送这些数据。

**作用：**
- 会话管理：维持用户登录状态
- 个性化设置：保存用户偏好设置
- 跟踪用户行为：记录用户访问历史

**安全隐患：**
- **XSS攻击**：恶意脚本可能窃取Cookie
- **CSRF攻击**：利用用户已登录的身份执行恶意操作
- **敏感信息泄露**：如果Cookie中存储敏感信息，可能被截获
- **会话劫持**：攻击者获取会话ID后冒充用户

为减少风险，应设置Cookie的安全属性（Secure、HttpOnly、SameSite）并避免在Cookie中存储敏感信息。

### 4. 如何使用隐藏表单域传递会话信息，一般用在什么情况下？

**答：** 隐藏表单域是在HTML表单中使用`<input type="hidden">`元素来传递会话信息的方法。

**使用方法：**
```html
<form action="process.jsp" method="post">
    <input type="hidden" name="sessionId" value="<%= session.getId() %>">
    <!-- 其他表单元素 -->
    <input type="submit" value="提交">
</form>
```

**适用情况：**
- 客户端禁用了Cookie
- 需要在表单提交时保持会话状态
- 不希望用户看到或修改的会话数据
- 作为URL重写的替代方案